(function(i){var f=0;var k="";var g="group-";var l="multiselectChange";var p="multiselectSearch";i.widget("uix.multiselect",{options:{availableListPosition:"right",collapsableGroups:true,defaultGroupName:"",filterSelected:false,locale:"auto",moveEffect:null,moveEffectOptions:{},moveEffectSpeed:null,optionRenderer:false,searchField:"toggle",searchHeader:"available",selectionMode:"click,d&d",showDefaultGroupHeader:false,showEmptyGroups:false,splitRatio:0.55,sortable:false,sortMethod:null},_create:function(){var v=this;var s,q,w,u;var r,t;this.scope="multiselect"+(f++);this.optionGroupIndex=1;this._setLocale(this.options.locale);this.element.addClass("uix-multiselect-original");this._elementWrapper=i("<div></div>").addClass("uix-multiselect ui-widget").css({width:this.element.outerWidth(),height:this.element.outerHeight()}).append(i("<div></div>").addClass("multiselect-selected-list").append(i("<div></div>").addClass("ui-widget-header").append(t=i("<button></button>").addClass("uix-control-right").attr("data-localekey","deselectAll").attr("title",this._t("deselectAll")).button({icons:{primary:"ui-icon-arrowthickstop-1-e"},text:false}).click(function(x){x.preventDefault();x.stopPropagation();v.optionCache.setSelectedAll(false);return false})).append(s=i("<div></div>").addClass("header-text"))).append(q=i("<div></div>").addClass("uix-list-container ui-widget-content")))["right,top".indexOf(this.options.availableListPosition)>=0?"prepend":"append"](i("<div></div>").addClass("multiselect-available-list").append(i("<div></div>").addClass("ui-widget-header").append(r=i("<button></button>").addClass("uix-control-right").attr("data-localekey","selectAll").attr("title",this._t("selectAll")).button({icons:{primary:"ui-icon-arrowthickstop-1-w"},text:false}).click(function(x){x.preventDefault();x.stopPropagation();v.optionCache.setSelectedAll(true);return false})).append(w=i("<div></div>").addClass("header-text"))).append(u=i("<div></div>").addClass("uix-list-container ui-widget-content"))).insertAfter(this.element);this._buttons={selectAll:r,deselectAll:t};this._headers={selected:s,available:w};this._lists={selected:q.attr("id",this.scope+"_selListContent"),available:u.attr("id",this.scope+"_avListContent")};this.optionCache=new h(this);this._searchDelayed=new m(this,{delay:500});this._initSearchable();this._applyListDroppable();this.refresh()},refresh:function(q){this._resize();c(function(){this.optionCache.cleanup();var w,u=this.element[0].childNodes;for(var v=0,s=u.length;v<s;v++){w=u[v];if(w.nodeType==1){if(w.tagName.toUpperCase()=="OPTGROUP"){var y=i(w).data("option-group")||(g+(this.optionGroupIndex++));var x=w.childNodes;this.optionCache.prepareGroup(i(w),y);for(var t=0,r=x.length;t<r;t++){w=x[t];if(w.nodeType==1){this.optionCache.prepareOption(i(w),y)}}}else{this.optionCache.prepareOption(i(w))}}}this.optionCache.reIndex();if(this._searchField&&this._searchField.is(":visible")){this._search(null,true)}if(q){q()}},10,this)},search:function(q){if(typeof q!="object"){q={showInput:true,text:q}}if((q.toggleInput!=false)&&!this._searchField.is(":visible")){this._buttons.search.trigger("click")}this._search(q.text,!!q.silent)},locale:function(q){if(q==undefined){return this.options.locale}else{this._setLocale(q);this._updateControls();this._updateHeaders()}},destroy:function(){this._super();this.optionCache.reset(true);this._lists.selected.empty().remove();this._lists.available.empty().remove();this._elementWrapper.empty().remove();delete this.optionCache;delete this._searchDelayed;delete this._lists;delete this._elementWrapper;this.element.removeClass("uix-multiselect-original")},_initSearchable:function(){var s=("toggle"===this.options.searchField);var r=this.options.searchHeader;if(s){var q=this;this._buttons.search=i("<button></button").addClass("uix-control-right").attr("data-localekey","search").attr("title",this._t("search")).button({icons:{primary:"ui-icon-search"},text:false}).click(function(u){u.preventDefault();u.stopPropagation();if(q._searchField.is(":visible")){var t=i(this);q._headers[r].css("visibility","visible").fadeTo("fast",1);q._searchField.hide("slide",{direction:"right"},200,function(){t.removeClass("ui-corner-right ui-state-active").addClass("ui-corner-all")});q._searchDelayed.cancelLastRequest();q.optionCache.filter("")}else{q._headers[r].fadeTo("fast",0.1,function(){i(this).css("visibility","hidden")});i(this).removeClass("ui-corner-all").addClass("ui-corner-right ui-state-active");q._searchField.show("slide",{direction:"right"},200,function(){i(this).focus()});q._search()}return false}).insertBefore(this._headers[r])}if(this.options.searchField){if(!s){this._headers[r].hide()}this._searchField=i('<input type="text" />').addClass("uix-search ui-widget-content ui-corner-"+(s?"left":"all"))[s?"hide":"show"]().insertBefore(this._headers[r]).focus(function(){i(this).select()}).keyup(i.proxy(this._searchDelayed.request,this._searchDelayed))}},_applyListDroppable:function(){if(this.options.selectionMode.indexOf("d&d")==-1){return}var q=this.optionCache;var r=this.scope;var u=function(v){return q._elements[v.data("element-index")]};var t=function(w,v){w.droppable({accept:function(x){var y=u(x);return y&&(y.selected!=v)},activeClass:"ui-state-highlight",scope:r,drop:function(x,y){y.draggable.removeClass("ui-state-disabled");y.helper.remove();q.setSelected(u(y.draggable),v)}})};t(this._lists.selected,true);t(this._lists.available,false);if(this.options.sortable){var s=this;this._lists.selected.sortable({appendTo:"parent",axis:"y",containment:i(".multiselect-selected-list",this._elementWrapper),items:".multiselect-element-wrapper",handle:".group-element",revert:true,stop:i.proxy(function(v,w){var x;i(".multiselect-element-wrapper",s._lists.selected).each(function(){var y=s.optionCache._groups.get(i(this).data("option-group"));if(!x){s.element.append(y.groupElement)}else{y.groupElement.insertAfter(x.groupElement)}x=y})},this)})}},_search:function(r,q){if(this._searchField.is(":visible")){if(r){this._searchField.val(r)}else{r=this._searchField.val()}}else{r=(""+r)}this.optionCache.filter(r,q)},_setLocale:function(q){if(q=="auto"){q=navigator.userLanguage||navigator.language||navigator.browserLanguage||navigator.systemLanguage||""}if(!i.uix.multiselect.i18n[q]){q=""}this.options.locale=q},_t:function(r,q,s){return o({locale:this.options.locale,key:r,plural:q,data:s})},_updateControls:function(){var q=this;i(".uix-control-left,.uix-control-right",this._elementWrapper).each(function(){i(this).attr("title",q._t(i(this).attr("data-localekey")))})},_updateHeaders:function(){var q,r=this.optionCache.getSelectionInfo();this._headers.selected.text(q=this._t("itemsSelected",r.selected.total,{count:r.selected.total})).parent().attr("title",this.options.filterSelected?this._t("itemsSelected",r.selected.count,{count:r.selected.count})+", "+this._t("itemsFiltered",r.selected.filtered,{count:r.selected.filtered}):q);this._headers.available.text(this._t("itemsAvailable",r.available.total,{count:r.available.total})).parent().attr("title",this._t("itemsAvailable",r.available.count,{count:r.available.count})+", "+this._t("itemsFiltered",r.available.filtered,{count:r.available.filtered}))},_resize:function(){var z=this.options.availableListPosition.toLowerCase();var u=("left,right".indexOf(z)>=0)?"Width":"Height";var t=("left,right".indexOf(z)>=0)?"Height":"Width";var D=this.element["outer"+u]()*this.options.splitRatio;var A=this.element["outer"+u]()-D;var q=(t==="Width")?D:this.element.outerHeight();var B=(t==="Width")?A:this.element.outerHeight();var C=("left,right".indexOf(z)>=0)?"left":"top";var s=("left,top".indexOf(z)>=0);var r=("toggle"===this.options.searchField);var v="ui-corner-tl ui-corner-tr ui-corner-bl ui-corner-br ui-corner-top";var y=(t==="Width")?(s?"":"ui-corner-top"):(s?"ui-corner-tr":"ui-corner-tl");var x=(t==="Width")?(s?"ui-corner-top":""):(s?"ui-corner-tl":"ui-corner-tr");this._elementWrapper.find(".multiselect-available-list")[u.toLowerCase()](A).css(C,s?0:D)[t.toLowerCase()](this.element["outer"+t]()+1);this._elementWrapper.find(".multiselect-selected-list")[u.toLowerCase()](D).css(C,s?A:0)[t.toLowerCase()](this.element["outer"+t]()+1);this._buttons.selectAll.button("option","icons",{primary:d(z,"ui-icon-arrowthickstop-1-",false)});this._buttons.deselectAll.button("option","icons",{primary:d(z,"ui-icon-arrowthickstop-1-",true)});this._headers.available.parent().removeClass(v).addClass(x);this._headers.selected.parent().removeClass(v).addClass(y);if(!r){var w=Math.max(this._headers.selected.parent().height(),this._headers.available.parent().height());this._headers.available.parent().height(w);this._headers.selected.parent().height(w)}if(this._searchField){this._searchField.width(this._headers.available.parent().width()-(r?48:24))}this._lists.available.height(B-this._headers.available.parent().outerHeight()-2);this._lists.selected.height(q-this._headers.selected.parent().outerHeight()-2)},_triggerUIEvent:function(q,r){if(typeof q=="string"){q=i.Event(q)}this.element.trigger(q,r);return !q.isDefaultPrevented()},_setOption:function(q,r){switch(q){}this._superApply(arguments)}});var j={standard:function(r,q){if(r>q){return 1}if(r<q){return -1}return 0},natural:function a(I,H){var D=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,u=/(^[ ]*|[ ]*$)/g,J=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,t=/^0x[0-9a-f]+$/i,r=/^0/,F=function(x){return a.insensitive&&(""+x).toLowerCase()||""+x},A=F(I).replace(u,"")||"",w=F(H).replace(u,"")||"",s=A.replace(D,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),C=w.replace(D,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),v=parseInt(A.match(t))||(s.length!=1&&A.match(J)&&Date.parse(A)),E=parseInt(w.match(t))||v&&w.match(J)&&Date.parse(w)||null,G,q;if(E){if(v<E){return -1}else{if(v>E){return 1}}}for(var B=0,z=Math.max(s.length,C.length);B<z;B++){G=!(s[B]||"").match(r)&&parseFloat(s[B])||s[B]||0;q=!(C[B]||"").match(r)&&parseFloat(C[B])||C[B]||0;if(isNaN(G)!==isNaN(q)){return(isNaN(G))?1:-1}else{if(typeof G!==typeof q){G+="";q+=""}}if(G<q){return -1}if(G>q){return 1}}return 0}};var e=["n","e","s","w"];var n=["bottom","left","top","right"];var d=function(s,r,q){return r+e[(i.inArray(s.toLowerCase(),n)+(q?2:0))%4]};var c=function(t,s,q){var r=Array.prototype.slice.call(arguments,3);return setTimeout(function(){t.apply(q||window,r)},s)};var m=function(r,q){this._widget=r;this._options=q;this._lastSearchValue=null};m.prototype={request:function(){if(this._widget._searchField.val()==this._lastSearchValue){return}this.cancelLastRequest();this._timeout=c(function(){this._timeout=null;this._lastSearchValue=this._widget._searchField.val();this._widget._search()},this._options.delay,this)},cancelLastRequest:function(){if(this._timeout){clearTimeout(this._timeout)}}};var b=function(s){var t=[];var r={};var q=s;this.setComparator=function(u){q=u;return this};this.clear=function(){t=[];r={};return this};this.containsKey=function(u){return !!r[u]};this.get=function(u){return r[u]};this.put=function(u,v){if(!r[u]){if(q){t.splice((function(){var x=0,A=t.length;var z=-1,B=0;while(x<A){z=parseInt((x+A)/2);var y=r[t[z]].groupElement;var w=v.groupElement;B=q(y?y.attr("label"):k,w?w.attr("label"):k);if(B<0){x=z+1}else{if(B>0){A=z}else{return z}}}return x})(),0,u)}else{t.push(u)}}r[u]=v;return this};this.remove=function(u){delete r[u];return t.splice(t.indexOf(u),1)};this.each=function(x){var v=Array.prototype.slice.call(arguments,1);v.splice(0,0,null,null);for(var w=0,u=t.length;w<u;w++){v[0]=t[w];v[1]=r[t[w]];x.apply(v[1],v)}return this}};var h=function(q){this._widget=q;this._listContainers={selected:i("<div></div>").appendTo(this._widget._lists.selected),available:i("<div></div>").appendTo(this._widget._lists.available)};this._elements=[];this._groups=new b();this._moveEffect={fn:q.options.moveEffect,options:q.options.moveEffectOptions,speed:q.options.moveEffectSpeed};this._selectionMode=this._widget.options.selectionMode.indexOf("dblclick")>-1?"dblclick":this._widget.options.selectionMode.indexOf("click")>-1?"click":false;this.reset()};h.Options={batchCount:200,batchDelay:50};h.prototype={_createGroupElement:function(w,E,t){var y=this;var C;var s=function(){if(!C){C=y._groups.get(E)}return C};var x=function(){return w?w.attr("label"):y._widget.options.defaultGroupName};var r=i("<span></span>").addClass("label").text(x()+" (0)").attr("title",x()+" (0)");var v=function(){var G=s()[t?"selected":"available"];G.listElement[(!t&&(G.count||y._widget.options.showEmptyGroups))||(G.count&&((C.optionGroup!=k)||y._widget.options.showDefaultGroupHeader))?"show":"hide"]();var F=x()+" ("+G.count+")";r.text(F).attr("title",F)};var A=i("<div></div>").addClass("ui-widget-header ui-priority-secondary group-element").append(i("<button></button>").addClass("uix-control-right").attr("data-localekey",(t?"de":"")+"selectAllGroup").attr("title",this._widget._t((t?"de":"")+"selectAllGroup")).button({icons:{primary:d(this._widget.options.availableListPosition,"ui-icon-arrowstop-1-",t)},text:false}).click(function(K){K.preventDefault();K.stopPropagation();var J=s()[t?"selected":"available"];if(C.count>0){var G=[];y._bufferedMode(true);for(var H=C.startIndex,F=C.startIndex+C.count,I;H<F;H++){I=y._elements[H];if(!I.filtered&&!I.selected!=t){y.setSelected(I,!t,true);G.push(I.optionElement[0])}}y._updateGroupElements(C);y._widget._updateHeaders();y._bufferedMode(false);y._widget._triggerUIEvent(l,{optionElements:G,selected:!t})}return false})).append(r);var q,z=(w)?w.attr("data-group-icon"):null;if(this._widget.options.collapsableGroups){var B=(w)?w.attr("data-collapse-icon"):null,D=(B)?"ui-icon "+B:"ui-icon ui-icon-triangle-1-s";var u=i("<span></span>").addClass("ui-icon collapse-handle").attr("data-localekey","collapseGroup").attr("title",this._widget._t("collapseGroup")).addClass(D).mousedown(function(F){F.stopPropagation()}).click(function(F){F.preventDefault();F.stopPropagation();q(w);return false}).prependTo(A.addClass("group-element-collapsable"));q=function(K){var J=s()[t?"selected":"available"],H=(K)?K.attr("data-collapse-icon"):null,F=(K)?K.attr("data-expand-icon"):null,I=(H)?"ui-icon "+H:"ui-icon ui-icon-triangle-1-s",G=(F)?"ui-icon "+F:"ui-icon ui-icon-triangle-1-e";J.collapsed=!J.collapsed;J.listContainer.slideToggle();u.removeClass(J.collapsed?I:G).addClass(J.collapsed?G:I)}}else{if(z){i("<span></span>").addClass("collapse-handle "+z).css("cursor","default").prependTo(A.addClass("group-element-collapsable"))}}return i("<div></div>").data("fnUpdateCount",v).data("fnToggle",q||i.noop).append(A)},_createGroupContainerElement:function(v,u,r){var s=this;var t=i("<div></div>");var q;if(this._widget.options.sortable&&r){t.sortable({tolerance:"pointer",appendTo:this._widget._elementWrapper,connectWith:this._widget._lists.available.attr("id"),scope:this._widget.scope,helper:"clone",receive:function(w,x){var y=s._elements[q=x.item.data("element-index")];y.selected=true;y.optionElement.prop("selected",true);y.listElement.removeClass("ui-state-active")},stop:function(w,x){var y;if(q){y=s._elements[q];q=undefined;x.item.replaceWith(y.listElement.addClass("ui-state-highlight option-selected"));s._widget._updateHeaders();s._widget._triggerUIEvent(l,{optionElements:[y.optionElement[0]],selected:true})}else{y=s._elements[x.item.data("element-index")];if(y&&!y.selected){s._bufferedMode(true);s._appendToList(y);s._bufferedMode(false)}}if(y){s._reorderSelected(y.optionGroup)}},revert:true})}if(this._selectionMode){i(t).on(this._selectionMode,"div.option-element",function(){var w=s._elements[i(this).data("element-index")];w.listElement.removeClass("ui-state-hover");s.setSelected(w,!r)})}return t},_createElement:function(r,v){var u=this._widget.options.optionRenderer?this._widget.options.optionRenderer(r,v):i("<div></div>").text(r.text());var q=r.attr("data-option-icon");var t=i("<div></div>").append(u).addClass("ui-state-default option-element").attr("unselectable","on").data("element-index",-1).hover(function(){if(r.prop("selected")){i(this).removeClass("ui-state-highlight")}i(this).addClass("ui-state-hover")},function(){i(this).removeClass("ui-state-hover");if(r.prop("selected")){i(this).addClass("ui-state-highlight")}});if(this._widget.options.selectionMode.indexOf("d&d")>-1){var s=this;t.draggable({addClasses:false,cancel:(this._widget.options.sortable?".option-selected, ":"")+".ui-state-disabled",appendTo:this._widget._elementWrapper,scope:this._widget.scope,start:function(w,x){i(this).addClass("ui-state-disabled ui-state-active");x.helper.width(i(this).width()).height(i(this).height())},stop:function(w,x){i(this).removeClass("ui-state-disabled ui-state-active")},helper:"clone",revert:"invalid",zIndex:99999,disabled:r.prop("disabled")});if(r.prop("disabled")){t.addClass("ui-state-disabled")}if(this._widget.options.sortable){t.draggable("option","connectToSortable",this._groups.get(v)["selected"].listContainer)}}else{if(r.prop("disabled")){t[(r.prop("disabled")?"add":"remove")+"Class"]("ui-state-disabled")}}if(q){t.addClass("grouped-option").prepend(i("<span></span>").addClass("ui-icon "+q))}return t},_isOptionCollapsed:function(q){return this._groups.get(q.optionGroup)[q.selected?"selected":"available"].collapsed},_updateGroupElements:function(s){if(s){s.selected.count=0;s.available.count=0;for(var r=s.startIndex,q=s.startIndex+s.count;r<q;r++){s[this._elements[r].selected?"selected":"available"].count++}s.selected.listElement.data("fnUpdateCount")();s.available.listElement.data("fnUpdateCount")()}else{this._groups.each(function(t,v,u){u._updateGroupElements(v)},this)}},_appendToList:function(r){var u=this;var t=this._groups.get(r.optionGroup);var v=t[r.selected?"selected":"available"];if((r.optionGroup!=this._widget.options.defaultGroupName)||this._widget.options.showDefaultGroupHeader){v.listElement.show()}if(v.collapsed){v.listElement.data("fnToggle")()}else{v.listContainer.show()}var q=r.index-1;while((q>=t.startIndex)&&(this._elements[q].selected!=r.selected)){q--}if(q<t.startIndex){v.listContainer.prepend(r.listElement)}else{var s=this._elements[q].listElement;if(s.parent().hasClass("ui-effects-wrapper")){s=s.parent()}r.listElement.insertAfter(s)}r.listElement[(r.selected?"add":"remove")+"Class"]("ui-state-highlight option-selected");if((r.selected||!r.filtered)&&!this._isOptionCollapsed(r)&&this._moveEffect&&this._moveEffect.fn){r.listElement.hide().show(this._moveEffect.fn,this._moveEffect.options,this._moveEffect.speed)}else{if(r.filtered){r.listElement.hide()}}},_reorderSelected:function(u){var t=this._elements;var s=this._groups.get(u);var r=s.groupElement?s.groupElement:this._widget.element;var q;i(".option-element",s.selected.listContainer).each(function(){var v=t[i(this).data("element-index")].optionElement;if(!q){r.prepend(v)}else{v.insertAfter(q)}q=v})},_bufferedMode:function(q){if(q){this._oldMoveEffect=this._moveEffect;this._moveEffect=null;this._widget._lists.selected.data("scrollTop",this._widget._lists.selected.scrollTop());this._widget._lists.available.data("scrollTop",this._widget._lists.available.scrollTop());this._listContainers.selected.detach();this._listContainers.available.detach()}else{this._widget._lists.selected.append(this._listContainers.selected).scrollTop(this._widget._lists.selected.data("scrollTop")||0);this._widget._lists.available.append(this._listContainers.available).scrollTop(this._widget._lists.available.data("scrollTop")||0);this._moveEffect=this._oldMoveEffect;delete this._oldMoveEffect}},reset:function(q){this._groups.clear();this._listContainers.selected.empty();this._listContainers.available.empty();if(q){i.each(this._elements,function(r,s){s.optionElement.removeData("element-index")});delete this._elements;delete this._groups;delete this._listContainers}else{this._elements=[];this.prepareGroup();this._groups.setComparator(this.getComparator())}},cleanup:function(){var u=this._widget.element[0];var t=[];this._groups.each(function(x,w){if(w.groupElement&&!i.contains(u,w.groupElement[0])){t.push(x)}});for(var r=0,s;r<this._elements.length;r++){s=this._elements[r];if(!i.contains(u,s.optionElement[0])||(i.inArray(s.optionGroup,t)>-1)){this._elements.splice(r--,1)[0].listElement.remove()}}for(var r=0,q=t.length;r<q;r++){this._groups.remove(t[r])}this.prepareGroup()},getComparator:function(){return this._widget.options.sortMethod?typeof this._widget.options.sortMethod=="function"?this._widget.options.sortMethod:j[this._widget.options.sortMethod]:null},prepareGroup:function(r,q){q=q||k;if(!this._groups.containsKey(q)){this._groups.put(q,{startIndex:-1,count:0,selected:{collapsed:false,count:0,listElement:this._createGroupElement(r,q,true),listContainer:this._createGroupContainerElement(r,q,true)},available:{collapsed:false,count:0,listElement:this._createGroupElement(r,q,false),listContainer:this._createGroupContainerElement(r,q,false)},groupElement:r,optionGroup:q})}},prepareOption:function(q,s){var r;if(q.data("element-index")===undefined){s=s||k;this._elements.push(r={index:-1,selected:false,filtered:false,listElement:this._createElement(q,s),optionElement:q,optionGroup:s})}else{this._elements[q.data("element-index")].listElement[(q.prop("disabled")?"add":"remove")+"Class"]("ui-state-disabled")}},reIndex:function(){var r=this.getComparator();if(r){var t=this._groups;this._elements.sort(function(x,w){var A=t.get(x.optionGroup).groupElement;var z=t.get(w.optionGroup).groupElement;var y=r(A?A.attr("label"):k,z?z.attr("label"):k);if(y!=0){return y}else{return r(x.optionElement.text(),w.optionElement.text())}})}this._bufferedMode(true);this._groups.each(function(A,y,x,w){if(!y.available.listContainer.parents(".multiselect-element-wrapper").length){if(y.groupElement){y.groupElement.data("option-group",A)}var z=i("<div></div>").addClass("multiselect-element-wrapper").data("option-group",A);var B=i("<div></div>").addClass("multiselect-element-wrapper").data("option-group",A);z.append(y.selected.listElement.hide());if(A!=k||(A==k&&w)){B.append(y.available.listElement.show())}z.append(y.selected.listContainer);B.append(y.available.listContainer);x.selected.append(z);x.available.append(B)}y.count=0},this._listContainers,this._widget.options.showDefaultGroupHeader);for(var s=0,u,v,q=this._elements.length;s<q;s++){u=this._elements[s];v=this._groups.get(u.optionGroup);if(v.startIndex==-1||v.startIndex>=s){v.startIndex=s;v.count=1}else{v.count++}u.listElement.data("element-index",u.index=s);if(u.optionElement.data("element-index")==undefined||u.selected!=u.optionElement.prop("selected")){u.selected=u.optionElement.prop("selected");u.optionElement.data("element-index",s);this._appendToList(u)}}this._updateGroupElements();this._widget._updateHeaders();this._groups.each(function(y,w,x){x._reorderSelected(y)},this);this._bufferedMode(false)},filter:function(x,r){if(x&&!r){var w={text:x};if(this._widget._triggerUIEvent(p,w)){x=w.text}else{return}}this._bufferedMode(true);var u=this._widget.options.filterSelected;x=(""+x).toLowerCase();if(x.length==0){x=false}for(var t=0,v,q=this._elements.length,s;t<q;t++){v=this._elements[t];s=!(!x||(v.optionElement.text().toLowerCase().indexOf(x)>-1));if((!v.selected||u)&&(v.filtered!=s)){v.listElement[s?"hide":"show"]();v.filtered=s}else{if(v.selected){v.filtered=false}}}this._widget._updateHeaders();this._bufferedMode(false)},getSelectionInfo:function(){var t={selected:{total:0,count:0,filtered:0},available:{total:0,count:0,filtered:0}};for(var r=0,q=this._elements.length;r<q;r++){var s=this._elements[r];t[s.selected?"selected":"available"][s.filtered?"filtered":"count"]++;t[s.selected?"selected":"available"].total++}return t},setSelected:function(s,r,q){if(s.optionElement.attr("disabled")&&r){return}s.optionElement.prop("selected",s.selected=r);this._appendToList(s);if(!q){if(this._widget.options.sortable&&r){this._reorderSelected(s.optionGroup)}this._updateGroupElements(this._groups.get(s.optionGroup));this._widget._updateHeaders();this._widget._triggerUIEvent(l,{optionElements:[s.optionElement[0]],selected:r})}},setSelectedAll:function(v){var r=[];var u={};this._bufferedMode(true);for(var s=0,t,q=this._elements.length;s<q;s++){t=this._elements[s];if(!((t.selected==v)||(t.optionElement.attr("disabled")||(v&&(t.filtered||t.selected))))){this.setSelected(t,v,true);r.push(t.optionElement[0]);u[t.optionGroup]=true}}if(this._widget.options.sortable&&v){var w=this;i.each(u,function(x){w._reorderSelected(x)})}this._updateGroupElements();this._widget._updateHeaders();this._bufferedMode(false);this._widget._triggerUIEvent(l,{optionElements:r,selected:v})}};function o(w){var q=i.uix.multiselect.i18n[w.locale]?w.locale:"";var v=i.uix.multiselect.i18n[q];var r=w.plural||0;var u=w.data||{};var s;if(r==2&&v[w.key+"_plural_two"]){s=v[w.key+"_plural_two"]}else{if((r==2||r==3)&&v[w.key+"_plural_few"]){s=v[w.key+"_plural_few"]}else{if(r>1&&v[w.key+"_plural"]){s=v[w.key+"_plural"]}else{if(r==0&&v[w.key+"_nil"]){s=v[w.key+"_nil"]}else{s=v[w.key]||""}}}}return s.replace(/\{([^\}]+)\}/g,function(t,x){return u[x]})}i.uix.multiselect.i18n={"":{itemsSelected_nil:"no selected option",itemsSelected:"{count} selected option",itemsSelected_plural:"{count} selected options",itemsAvailable_nil:"no item available",itemsAvailable:"{count} available option",itemsAvailable_plural:"{count} available options",itemsFiltered_nil:"no option filtered",itemsFiltered:"{count} option filtered",itemsFiltered_plural:"{count} options filtered",selectAll:"Select All",deselectAll:"Deselect All",search:"Search Options",collapseGroup:"Collapse Group",expandGroup:"Expand Group",selectAllGroup:"Select All Group",deselectAllGroup:"Deselect All Group"}}})(jQuery);
